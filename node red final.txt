import time
import sys
import ibmiotf.application
import ibmiotf.device
import random

organization="4fvzwi"
deviceType="raspberrypi"
deviceId="93455"
authMethod="token"
authToken="9345567410" 

try:
    deviceOptions={"org": organization,"type": deviceType,"id": deviceId,"auth-method": authMethod,"auth-token": authToken}
    deviceCli=ibmiotf.device.Client(deviceOptions)
except Exception as e:
    print("caught exception connecting device:%s" % str(e))
    sys.exit()
    
deviceCli.connect()
while True:
          #in data
          name="priyanka"
          #lattitude=11.229592;
          #longtitude=  78.171158;
          #out data
          lattitude=12.7345;
          longtitude=13.2020;
          
          data={'lat':lattitude,'lon':longtitude,'name':name}
          def myOnPublishCallback():
            print("published lattitude=%d" %lattitude,"longtitude=%d" %longtitude,"to ibm watson")
          
        
          success=deviceCli.publishEvent("IotSensor","json",data,qos=0,on_publish=myOnPublishCallback)
          if not success:
              print("Not connected to IoTF")
          time.sleep(3)
deviceCli.disconnect()
